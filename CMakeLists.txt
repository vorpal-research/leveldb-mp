cmake_minimum_required(VERSION 3.3)

include_directories(./ ../)
include_directories(${PROJECT_SOURCE_DIR})
include_directories(/usr/include/leveldb)
include_directories(libsocket/headers)
add_subdirectory(libsocket)

set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${PROJECT_SOURCE_DIR})
set(LIBRARY_OUTPUT_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR}/lib)
link_directories(${CMAKE_CURRENT_BINARY_DIR}/lib)

#daemon executable
project(leveldb_daemon)

set(DAEMON_SOURCE_FILES
        leveldb_daemon.cpp
        ipc/Server.cpp
        ipc/Command.cpp
        logging/Logger.h
        storage/Database.cpp
        util/Util.cpp)

add_executable(leveldb_daemon ${DAEMON_SOURCE_FILES})
set_property(TARGET leveldb_daemon PROPERTY CXX_STANDARD 14)
set_property(TARGET leveldb_daemon PROPERTY CXX_STANDARD_REQUIRED ON)

add_dependencies(leveldb_daemon socket++)
target_link_libraries(leveldb_daemon socket++)
target_link_libraries(leveldb_daemon leveldb)

#shared library for client
project(leveldb_client)

set(LIB_SOURCE_FILES
        ipc/Client.cpp
        ipc/Command.cpp
        include/DB.cpp
        logging/Logger.h
        include/Serializer.hpp
        util/Util.cpp)

add_library(leveldb_client STATIC ${LIB_SOURCE_FILES})
set_property(TARGET leveldb_client PROPERTY CXX_STANDARD 14)
set_property(TARGET leveldb_client PROPERTY CXX_STANDARD_REQUIRED ON)

add_dependencies(leveldb_client socket++)
target_link_libraries(leveldb_client socket++)
